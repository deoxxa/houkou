function merge(e,t){for(var r={},i=0;i<e.length;++i)r[e[i]]=t[i];return r}function Houkou(e,t){if(!(this instanceof Houkou))return new Houkou(e,t);var r=this;this.cfg=t||{},this.cfg.requirements||(this.cfg.requirements={}),this.cfg.defaults||(this.cfg.defaults={}),this.cfg.paramChar||(this.cfg.paramChar=":");var i=new RegExp(this.cfg.paramChar+"([a-z_]+)","gi");this.parameters=(e.match(i)||[]).map(function(e){return e.substr(1)}),this.pattern=new RegExp("^"+e.replace(/\//g,"\\/").replace(/\./g,"\\.").replace(i,function(e,t){return"("+(r.cfg.requirements[t]||".+?")+")"})+"$"),this.build=new Function("v",'return !this.validate(v) ? false : "'+e.replace(i,'" + ((typeof v["$1"] !== "undefined" && v["$1"] !== null) ? v["$1"] : this.cfg.defaults["$1"]) + "')+'";')}Houkou.prototype.validate=function(e){for(var t in e)if(e.hasOwnProperty(t)&&this.cfg.requirements[t]&&!RegExp(this.cfg.requirements[t]).test(e[t]))return!1;return!0},Houkou.prototype.match=function(e){var t;return(t=this.pattern.exec(e))?(t.shift(),merge(this.parameters,t)):!1},"object"==typeof module&&(module.exports=Houkou);